{"version":3,"sources":["webpack:///src/app/home/home.page.html","webpack:///src/app/home/home-routing.module.ts","webpack:///src/app/home/home.module.ts","webpack:///src/app/home/home.page.scss","webpack:///src/app/home/home.page.ts"],"names":["routes","path","component","HomePageRoutingModule","imports","forChild","exports","HomePageModule","declarations","LIGHTBULB_SERVICE","SWITCH_CHARACTERISTIC","DIMMER_CHARACTERISTIC","HomePage","ble","ngZone","toastCtrl","alertCtrl","devices","peripheral","console","log","scan","setStatus","subscribe","device","onDeviceDiscovered","error","scanError","setTimeout","bind","JSON","stringify","run","push","create","message","position","duration","toast","present","devicevl","name","connect","id","onConnected","showAlert","read","then","buffer","data","Uint8Array","lockvalue","event","value","write","e","statusMessage","title","header","buttons","alert","selector","template"],"mappings":"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","file":"home-home-module-es5.js","sourcesContent":["export default \"<ion-header>\\n  <ion-toolbar>\\n    <ion-title style=\\\"text-align: center;\\\">\\n      Dyfo Bluetooth Lock System\\n    </ion-title>\\n    \\n  </ion-toolbar>\\n</ion-header>\\n<ion-content>\\n<ion-button expand=\\\"full\\\" (click)=\\\"scan()\\\" slot=\\\"end\\\">\\n  <ion-icon name=\\\"Bluetooth\\\"></ion-icon>\\n  <p>Scan</p>\\n</ion-button>\\n\\n\\n  <ion-list> \\n   \\n    <ion-button *ngFor=\\\"let device of devices\\\" (click)=\\\"deviceSelected(device)\\\">\\n      <h2>{{device.name || 'Unnamed' }}fghhg</h2>\\n      <p>{{device.id}}</p>\\n      <p>RSSI: {{device.rssi}}</p>\\n    </ion-button>\\n  </ion-list>\\n\\n  <ion-item>\\n    <ion-label>Lock/UnLock</ion-label>\\n    <ion-toggle [(ngModel)]=\\\"lockvalue\\\"  (ionChange)=\\\"onLockClick($event);\\\"></ion-toggle>\\n  </ion-item>\\n</ion-content>\\n\\n<ion-footer>\\n  <ion-toolbar style=\\\"text-align: center;\\\">\\n    <p>{{ statusMessage }}</p>\\n  </ion-toolbar>\\n</ion-footer>\";","import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { HomePage } from './home.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: HomePage,\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class HomePageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { IonicModule } from '@ionic/angular';\nimport { FormsModule } from '@angular/forms';\nimport { HomePage } from './home.page';\n\nimport { HomePageRoutingModule } from './home-routing.module';\n\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    HomePageRoutingModule\n  ],\n  declarations: [HomePage]\n})\nexport class HomePageModule {}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL2hvbWUvaG9tZS5wYWdlLnNjc3MifQ== */\";","import { Component, NgZone } from '@angular/core';\nimport { BLE } from '@ionic-native/ble/ngx';\nimport { ToastController, NavParams, AlertController } from '@ionic/angular';\n\n\n\nconst LIGHTBULB_SERVICE = 'ff10';\nconst SWITCH_CHARACTERISTIC = 'ff11';\nconst DIMMER_CHARACTERISTIC = 'ff12';\n\n@Component({\n  selector: 'app-home',\n  templateUrl: 'home.page.html',\n  styleUrls: ['home.page.scss'],\n})\nexport class HomePage {\n  devices: any[] = [];\n  devicevl;\n  statusMessage: string;\n\n  peripheral: any = {};\n  lockvalue: boolean;\n  \n  constructor(private ble: BLE,\n             private ngZone: NgZone,              \n             private toastCtrl: ToastController,\n             private alertCtrl: AlertController\n             ) {}\n\n             ionViewDidEnter(){\n               console.log('ionviewDidEnter');\n               this.scan();\n             }\n             scan(){\n              this.setStatus('Scanning for Bluetooth LE Devices...');\n              this.devices = [];  // clear list\n              this.ble.scan([LIGHTBULB_SERVICE],5).subscribe(\n                device => this.onDeviceDiscovered(device), \n                error => this.scanError(error.error)\n              );\n              setTimeout(this.setStatus.bind(this), 5000, 'Scan complete');\n             }\n\n             onDeviceDiscovered(device) {\n              console.log('Discovered ' + JSON.stringify(device, null, 2));\n              this.ngZone.run(() => {\n                this.devices.push(device);\n              });\n            }\n\n            // If location permission is denied, you'll end up here\n async scanError(error) {\n    this.setStatus('Error ' + error);\n    let toast =await this.toastCtrl.create({\n      message: 'Error scanning for Bluetooth low energy devices',\n      position: 'middle',\n      duration: 5000\n    });\n    toast.present();\n  }\n  deviceSelected(device) {\n    this.devicevl=device;\n    console.log(JSON.stringify(this.devicevl) + ' selected');\n    console.log(\"getdevice detailsafterclickbt:\"+ JSON.stringify(this.devicevl))\n   \n    this.setStatus('Connecting to ' + device.name || device.id);\n    this.ble.connect(device.id).subscribe(\n      peripheral => this.onConnected(peripheral),\n      peripheral => this.showAlert('Disconnected', 'The peripheral unexpectedly disconnected')\n    );\n  }\n  onConnected(peripheral) {\n\n    this.peripheral = peripheral;\n    this.setStatus('Connected to ' + (peripheral.name || peripheral.id));\n\n    // Update the UI with the current state of the switch characteristic\n    this.ble.read(this.peripheral.id, LIGHTBULB_SERVICE, SWITCH_CHARACTERISTIC).then(\n      buffer => {\n        let data = new Uint8Array(buffer);\n        console.log('switch characteristic ' + data[0]);\n        this.ngZone.run(() => {\n            this.lockvalue = data[0] !== 0;\n        });\n      }\n    )    \n  }\n\n  onLockClick(event) {\n    console.log('onlockvalueSwitchChange');\n    let value = this.lockvalue ? 1 : 0;\n    let buffer = new Uint8Array([value]).buffer;\n    console.log('lockvalue Switch Property ' + this.lockvalue);\n    console.log(buffer)\n    this.ble.write(this.peripheral.id, LIGHTBULB_SERVICE, SWITCH_CHARACTERISTIC, buffer).then(\n      () => this.setStatus('Light is ' + (this.lockvalue ? 'on' : 'off')),\n      e => this.showAlert('Unexpected Error', 'Error updating lockvalue switch')\n    );\n  }\n\n  setStatus(message) {\n    console.log(message);\n    this.ngZone.run(() => {\n      this.statusMessage = message;\n    });\n  }\n\n async showAlert(title, message) {\n    let alert = await this.alertCtrl.create({\n      header: title,\n      message: message,\n      buttons: ['OK']\n    });\n    alert.present();\n  }\n\n}\n"]}